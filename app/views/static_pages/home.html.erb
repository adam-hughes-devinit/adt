<% provide(:title, 'Home') %>
<script>
  $('body')
    .css('background-image', 'url("<%= image_path "gray_to_white.png" %>")')
</script>

<!-- Toggles banner when youtube video is played/paused.  -->
<script>
    var tag = document.createElement('script');

    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    var slide_1, slide_2, slide_3, slide_4, slide_5;
    // Creates youtube players for api to use.
    // The variables match the iframe id generated by embed_youtube.
    function onYouTubeIframeAPIReady() {
        slide_1 = new YT.Player('slide_1', {
            events: {
                'onStateChange': on_youtube_play
            }
        });
        slide_2 = new YT.Player('slide_2', {
            events: {
                'onStateChange': on_youtube_play
            }
        });
        slide_3 = new YT.Player('slide_3', {
            events: {
                'onStateChange': on_youtube_play
            }
        });
        slide_4 = new YT.Player('slide_4', {
            events: {
                'onStateChange': on_youtube_play
            }
        });
        slide_5 = new YT.Player('slide_5', {
            events: {
                'onStateChange': on_youtube_play

            }
        });

    }
    // Handle caption toggle.
    function on_youtube_play(event) {
        //console.log("state Change!", event)
        if (event.data == YT.PlayerState.PLAYING ) {
            //console.log("Youtube playing")
            $('.youtube-caption').slideToggle()
            $('#home_carousel').carousel('pause')
        }
        else if (event.data == YT.PlayerState.PAUSED) {
            //console.log("Youtube paused")
            $('.youtube-caption').slideToggle()
            $('#home_carousel').carousel('cycle')
        }
    }

</script>


<style>
    .banner-text {
        display: inline-table;
        text-align: inherit;
        padding-left: 10px;
        padding-right: 10px

    }

    .banner-text h2 {
        color:#ffffff;
        font-size: 17px;
    }
    .banner-text h4 {
        color:#ffffff;
        font-size: 15px;

    }

    .banner-text a:link {
        color:#3BB9FF;
    }
    .banner-text a:visited {
        color:#3BB9FF;
    }
</style>


<div class='row-fluid' id='home_first_row' >
  <div class='span6'>

    <div id='home_carousel' class='carousel slide xwith_shadow'>
      <ol class='carousel-indicators'>
        <li data-target='#home_carousel' data-slide-to='0' class='active'></li>
        <li data-target='#home_carousel' data-slide-to='1'></li>
        <li data-target='#home_carousel' data-slide-to='2'></li>
        <li data-target='#home_carousel' data-slide-to='3'></li>
      </ol>
      <div class='carousel-inner'>

        <%= render "home_media_viewer" %>
      </div>
      <a class='carousel-control left' href='#home_carousel' data-slide='prev'>&lsaquo;</a>
      <a class='carousel-control right' href='#home_carousel' data-slide='next'>&rsaquo;</a>
    </div>

  </div>
  <div id='stats-box' class='span6 container-fluid'>

    <div class='row-fluid'>
      <div class=''>
        <%= 
          render 'vital_stats' 
        %>
      </div>
    </div>
    <div class='row-fluid'>
      <div class=' alert alert-warning'>
        <%= render 'shared/recent'
         %>
      </div>
    </div>
  </div>
</div>

<div class='row-fluid' style="margin: 10px 0px 10px 0px;">
  <span class='span4'>
    <h4>
      <%= link_to "How to Use the Data", content_by_name_path("using_the_data"), class: "btn btn-large btn-info btn-block  home-button" %>
    </h4>
  </span>
  <span class='span4'>
    <h4>
      <%=link_to "Help us Improve the Data", content_by_name_path("improving_the_data"), class: "btn btn-large btn-block home-button" %>
    </h4>
  </span>
  <span class='span4'>
    <h4>
      <%=link_to "Coming Soon: Geocoded Data", content_by_name_path("geocoding"), class: "btn btn-large btn-warning btn-block home-button" %>
    </h4>
  </span>
</div>

<div class='row-fluid home_thumbnails'>
  <ul class='thumbnails '>
    <li class='span3'>
      <a href="<%= bubbles_path %>" class="thumbnail with_shadow">
        <h4>See the Big Picture &rarr;</h4>
        <%= image_tag("bubble_button.jpg", :alt => "Bubble Chart") %>
        
        
      </a>
    </li>
    <li class='span3'>
      <a href="<%= map_path %>" class="thumbnail with_shadow">
        <h4>Country-Level Perspective &rarr;</h4>
        <%= image_tag("map_button.png", :alt => "Map Overlay") %>
      </a>
    </li>
    <li class='span3' id='project_button' >
      <a href="<%= projects_path %>" class="thumbnail with_shadow">
        <h4>Project-Level Data &rarr;</h4>
        <%= image_tag("project_button_small.jpg", :alt => "Project Pages") %>
      </a>
    </li>
    <li class='span3'>
      <a href="<%= content_by_name_path("downloads") %>" class="thumbnail with_shadow">
        <h4>Download Data &rarr;</h4>
        <%= image_tag("aggregate_button.jpg", :alt => "Downloads") %>
      </a>
    </li>
  </ul>
</div>

<div class='row-fluid' id='home_media'>
  <div class='span12 row-fluid well'>
    <div class='span4'>
      <h3>
        In the News:
      </h3>
      <%= render 'latest_articles' %>
    </div>
    <div class='span4'>
      <h3>
        Recent Tweets:
      </h3>
      <%= render '/shared/twitter' %>
    </div>
    <div class='span4'>
      <h3>
        Publications:
      </h3>
      <%= render 'latest_publications' %>
    </div>
  </div>  
</div>
