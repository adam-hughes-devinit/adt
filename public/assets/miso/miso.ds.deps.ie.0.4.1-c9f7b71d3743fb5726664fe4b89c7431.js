/**
* Miso.Dataset - v0.4.1 - 11/19/2012
* http://github.com/misoproject/dataset
* Copyright (c) 2012 Alex Graul, Irene Ros;
* Dual Licensed: MIT, GPL
* https://github.com/misoproject/dataset/blob/master/LICENSE-MIT 
* https://github.com/misoproject/dataset/blob/master/LICENSE-GPL 
*/
// moment.js
// version : 1.7.2
// author : Tim Wood
// license : MIT
// momentjs.com
((function(a){function E(a,b,c,d){var e=c.lang();return e[a].call?e[a](c,d):e[a][b]}function F(a,b){return function(c){return K(a.call(this,c),b)}}function G(a){return function(b){var c=a.call(this,b);return c+this.lang().ordinal(c)}}function H(a,b,c){this._d=a,this._isUTC=!!b,this._a=a._a||null,this._lang=c||!1}function I(a){var b=this._data={},c=a.years||a.y||0,d=a.months||a.M||0,e=a.weeks||a.w||0,f=a.days||a.d||0,g=a.hours||a.h||0,h=a.minutes||a.m||0,i=a.seconds||a.s||0,j=a.milliseconds||a.ms||0;this._milliseconds=j+i*1e3+h*6e4+g*36e5,this._days=f+e*7,this._months=d+c*12,b.milliseconds=j%1e3,i+=J(j/1e3),b.seconds=i%60,h+=J(i/60),b.minutes=h%60,g+=J(h/60),b.hours=g%24,f+=J(g/24),f+=e*7,b.days=f%30,d+=J(f/30),b.months=d%12,c+=J(d/12),b.years=c,this._lang=!1}function J(a){return a<0?Math.ceil(a):Math.floor(a)}function K(a,b){var c=a+"";while(c.length<b)c="0"+c;return c}function L(a,b,c){var d=b._milliseconds,e=b._days,f=b._months,g;d&&a._d.setTime(+a+d*c),e&&a.date(a.date()+e*c),f&&(g=a.date(),a.date(1).month(a.month()+f*c).date(Math.min(g,a.daysInMonth())))}function M(a){return Object.prototype.toString.call(a)==="[object Array]"}function N(a,b){var c=Math.min(a.length,b.length),d=Math.abs(a.length-b.length),e=0,f;for(f=0;f<c;f++)~~a[f]!==~~b[f]&&e++;return e+d}function O(a,b,c,d){var e,f,g=[];for(e=0;e<7;e++)g[e]=a[e]=a[e]==null?e===2?1:0:a[e];return a[7]=g[7]=b,a[8]!=null&&(g[8]=a[8]),a[3]+=c||0,a[4]+=d||0,f=new Date(0),b?(f.setUTCFullYear(a[0],a[1],a[2]),f.setUTCHours(a[3],a[4],a[5],a[6])):(f.setFullYear(a[0],a[1],a[2]),f.setHours(a[3],a[4],a[5],a[6])),f._a=g,f}function P(a,c){var d,e,g=[];!c&&h&&(c=require("./lang/"+a));for(d=0;d<i.length;d++)c[i[d]]=c[i[d]]||f.en[i[d]];for(d=0;d<12;d++)e=b([2e3,d]),g[d]=new RegExp("^"+(c.months[d]||c.months(e,""))+"|^"+(c.monthsShort[d]||c.monthsShort(e,"")).replace(".",""),"i");return c.monthsParse=c.monthsParse||g,f[a]=c,c}function Q(a){var c=typeof a=="string"&&a||a&&a._lang||null;return c?f[c]||P(c):b}function R(a){return a.match(/\[.*\]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function S(a){var b=a.match(k),c,d;for(c=0,d=b.length;c<d;c++)D[b[c]]?b[c]=D[b[c]]:b[c]=R(b[c]);return function(e){var f="";for(c=0;c<d;c++)f+=typeof b[c].call=="function"?b[c].call(e,a):b[c];return f}}function T(a,b){function d(b){return a.lang().longDateFormat[b]||b}var c=5;while(c--&&l.test(b))b=b.replace(l,d);return A[b]||(A[b]=S(b)),A[b](a)}function U(a){switch(a){case"DDDD":return p;case"YYYY":return q;case"S":case"SS":case"SSS":case"DDD":return o;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return r;case"Z":case"ZZ":return s;case"T":return t;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return n;default:return new RegExp(a.replace("\\",""))}}function V(a,b,c,d){var e,f;switch(a){case"M":case"MM":c[1]=b==null?0:~~b-1;break;case"MMM":case"MMMM":for(e=0;e<12;e++)if(Q().monthsParse[e].test(b)){c[1]=e,f=!0;break}f||(c[8]=!1);break;case"D":case"DD":case"DDD":case"DDDD":b!=null&&(c[2]=~~b);break;case"YY":c[0]=~~b+(~~b>70?1900:2e3);break;case"YYYY":c[0]=~~Math.abs(b);break;case"a":case"A":d.isPm=(b+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":c[3]=~~b;break;case"m":case"mm":c[4]=~~b;break;case"s":case"ss":c[5]=~~b;break;case"S":case"SS":case"SSS":c[6]=~~(("0."+b)*1e3);break;case"Z":case"ZZ":d.isUTC=!0,e=(b+"").match(x),e&&e[1]&&(d.tzh=~~e[1]),e&&e[2]&&(d.tzm=~~e[2]),e&&e[0]==="+"&&(d.tzh=-d.tzh,d.tzm=-d.tzm)}b==null&&(c[8]=!1)}function W(a,b){var c=[0,0,1,0,0,0,0],d={tzh:0,tzm:0},e=b.match(k),f,g;for(f=0;f<e.length;f++)g=(U(e[f]).exec(a)||[])[0],g&&(a=a.slice(a.indexOf(g)+g.length)),D[e[f]]&&V(e[f],g,c,d);return d.isPm&&c[3]<12&&(c[3]+=12),d.isPm===!1&&c[3]===12&&(c[3]=0),O(c,d.isUTC,d.tzh,d.tzm)}function X(a,b){var c,d=a.match(m)||[],e,f=99,g,h,i;for(g=0;g<b.length;g++)h=W(a,b[g]),e=T(new H(h),b[g]).match(m)||[],i=N(d,e),i<f&&(f=i,c=h);return c}function Y(a){var b="YYYY-MM-DDT",c;if(u.exec(a)){for(c=0;c<4;c++)if(w[c][1].exec(a)){b+=w[c][0];break}return s.exec(a)?W(a,b+" Z"):W(a,b)}return new Date(a)}function Z(a,b,c,d,e){var f=e.relativeTime[a];return typeof f=="function"?f(b||1,!!c,a,d):f.replace(/%d/i,b||1)}function $(a,b,c){var e=d(Math.abs(a)/1e3),f=d(e/60),g=d(f/60),h=d(g/24),i=d(h/365),j=e<45&&["s",e]||f===1&&["m"]||f<45&&["mm",f]||g===1&&["h"]||g<22&&["hh",g]||h===1&&["d"]||h<=25&&["dd",h]||h<=45&&["M"]||h<345&&["MM",d(h/30)]||i===1&&["y"]||["yy",i];return j[2]=b,j[3]=a>0,j[4]=c,Z.apply({},j)}function _(a,c){b.fn[a]=function(a){var b=this._isUTC?"UTC":"";return a!=null?(this._d["set"+b+c](a),this):this._d["get"+b+c]()}}function ba(a){b.duration.fn[a]=function(){return this._data[a]}}function bb(a,c){b.duration.fn["as"+a]=function(){return+this/c}}var b,c="1.7.2",d=Math.round,e,f={},g="en",h=typeof module!="undefined"&&module.exports,i="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),j=/^\/?Date\((\-?\d+)/i,k=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,l=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,m=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,n=/\d\d?/,o=/\d{1,3}/,p=/\d{3}/,q=/\d{1,4}/,r=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,s=/Z|[\+\-]\d\d:?\d\d/i,t=/T/i,u=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,v="YYYY-MM-DDTHH:mm:ssZ",w=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],x=/([\+\-]|\d\d)/gi,y="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),z={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},A={},B="DDD w M D d".split(" "),C="M D H h m s w".split(" "),D={M:function(){return this.month()+1},MMM:function(a){return E("monthsShort",this.month(),this,a)},MMMM:function(a){return E("months",this.month(),this,a)},D:function(){return this.date()},DDD:function(){var a=new Date(this.year(),this.month(),this.date()),b=new Date(this.year(),0,1);return~~((a-b)/864e5+1.5)},d:function(){return this.day()},dd:function(a){return E("weekdaysMin",this.day(),this,a)},ddd:function(a){return E("weekdaysShort",this.day(),this,a)},dddd:function(a){return E("weekdays",this.day(),this,a)},w:function(){var a=new Date(this.year(),this.month(),this.date()-this.day()+5),b=new Date(a.getFullYear(),0,4);return~~((a-b)/864e5/7+1.5)},YY:function(){return K(this.year()%100,2)},YYYY:function(){return K(this.year(),4)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return K(~~(this.milliseconds()/10),2)},SSS:function(){return K(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+K(~~(a/60),2)+":"+K(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+K(~~(10*a/6),4)}};while(B.length)e=B.pop(),D[e+"o"]=G(D[e]);while(C.length)e=C.pop(),D[e+e]=F(D[e],2);D.DDDD=F(D.DDD,3),b=function(c,d){if(c===null||c==="")return null;var e,f;return b.isMoment(c)?new H(new Date(+c._d),c._isUTC,c._lang):(d?M(d)?e=X(c,d):e=W(c,d):(f=j.exec(c),e=c===a?new Date:f?new Date(+f[1]):c instanceof Date?c:M(c)?O(c):typeof c=="string"?Y(c):new Date(c)),new H(e))},b.utc=function(a,c){return M(a)?new H(O(a,!0),!0):(typeof a=="string"&&!s.exec(a)&&(a+=" +0000",c&&(c+=" Z")),b(a,c).utc())},b.unix=function(a){return b(a*1e3)},b.duration=function(a,c){var d=b.isDuration(a),e=typeof a=="number",f=d?a._data:e?{}:a,g;return e&&(c?f[c]=a:f.milliseconds=a),g=new I(f),d&&(g._lang=a._lang),g},b.humanizeDuration=function(a,c,d){return b.duration(a,c===!0?null:c).humanize(c===!0?!0:d)},b.version=c,b.defaultFormat=v,b.lang=function(a,c){var d;if(!a)return g;(c||!f[a])&&P(a,c);if(f[a]){for(d=0;d<i.length;d++)b[i[d]]=f[a][i[d]];b.monthsParse=f[a].monthsParse,g=a}},b.langData=Q,b.isMoment=function(a){return a instanceof H},b.isDuration=function(a){return a instanceof I},b.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10;return~~(a%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"}}),b.fn=H.prototype={clone:function(){return b(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this._d.toString()},toDate:function(){return this._d},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?this._a[8]!=null?!!this._a[8]:!N(this._a,(this._a[7]?b.utc(this._a):b(this._a)).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(a){return T(this,a?a:b.defaultFormat)},add:function(a,c){var d=c?b.duration(+c,a):b.duration(a);return L(this,d,1),this},subtract:function(a,c){var d=c?b.duration(+c,a):b.duration(a);return L(this,d,-1),this},diff:function(a,c,e){var f=this._isUTC?b(a).utc():b(a).local(),g=(this.zone()-f.zone())*6e4,h=this._d-f._d-g,i=this.year()-f.year(),j=this.month()-f.month(),k=this.date()-f.date(),l;return c==="months"?l=i*12+j+k/30:c==="years"?l=i+(j+k/30)/12:l=c==="seconds"?h/1e3:c==="minutes"?h/6e4:c==="hours"?h/36e5:c==="days"?h/864e5:c==="weeks"?h/6048e5:h,e?l:d(l)},from:function(a,c){return b.duration(this.diff(a)).lang(this._lang).humanize(!c)},fromNow:function(a){return this.from(b(),a)},calendar:function(){var a=this.diff(b().sod(),"days",!0),c=this.lang().calendar,d=c.sameElse,e=a<-6?d:a<-1?c.lastWeek:a<0?c.lastDay:a<1?c.sameDay:a<2?c.nextDay:a<7?c.nextWeek:d;return this.format(typeof e=="function"?e.apply(this):e)},isLeapYear:function(){var a=this.year();return a%4===0&&a%100!==0||a%400===0},isDST:function(){return this.zone()<b([this.year()]).zone()||this.zone()<b([this.year(),5]).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return a==null?b:this.add({d:a-b})},startOf:function(a){switch(a.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(a){return this.startOf(a).add(a.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return b.utc([this.year(),this.month()+1,0]).date()},lang:function(b){return b===a?Q(this):(this._lang=b,this)}};for(e=0;e<y.length;e++)_(y[e].toLowerCase(),y[e]);_("year","FullYear"),b.duration.fn=I.prototype={weeks:function(){return J(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(a){var b=+this,c=this.lang().relativeTime,d=$(b,!a,this.lang()),e=b<=0?c.past:c.future;return a&&(typeof e=="function"?d=e(d):d=e.replace(/%s/i,d)),d},lang:b.fn.lang};for(e in z)z.hasOwnProperty(e)&&(bb(e,z[e]),ba(e.toLowerCase()));bb("Weeks",6048e5),h&&(module.exports=b),typeof ender=="undefined"&&(this.moment=b),typeof define=="function"&&define.amd&&define("moment",[],function(){return b})})).call(this),function(a,b){function bj(a){if(a&&a.__wrapped__)return a;if(!(this instanceof bj))return new bj(a);this.__wrapped__=a}function bo(a,b,c){b||(b=0);var d=a.length,e=d-b>=(c||i),f=e?{}:a;if(e){var g=b-1;while(++g<d){var h=a[g]+"";(B.call(f,h)?f[h]:f[h]=[]).push(a[g])}}return function(a){if(e){var c=a+"";return B.call(f,c)&&cD(f[c],a)>-1}return cD(f,a,b)>-1}}function bp(a,c){var d=a.index,e=c.index;a=a.criteria,c=c.criteria;if(a!==c){if(a>c||a===b)return 1;if(a<c||c===b)return-1}return d<e?-1:1}function bq(a,b,c){function g(){var h=arguments,i=e?this:b;d||(a=b[f]),c.length&&(h=h.length?c.concat(E.call(h)):c);if(this instanceof g){bv.prototype=a.prototype,i=new bv;var j=a.apply(i,h);return j&&bh[typeof j]?j:i}return a.apply(i,h)}var d=bR(a),e=!c,f=a;return e&&(c=b),g}function br(a,c){return a?typeof a!="function"?function(b){return b[a]}:c!==b?function(b,d,e){return a.call(c,b,d,e)}:a:dc}function bs(){var a={arrayLoop:"",bottom:"",hasDontEnumBug:W,isKeysFast:be,objectLoop:"",noArgsEnum:Z,noCharByIndex:ba,shadowed:v,top:"",useHas:!0};for(var b,c=0;b=arguments[c];c++)for(var d in b)a[d]=b[d];var e=a.args;a.firstArg=/^[^,]+/.exec(e)[0];var f=Function("createCallback, hasOwnProperty, isArguments, objectTypes, nativeKeys, propertyIsEnumerable, stringClass, toString","return function("+e+") {\n"+bk(a)+"\n}");return f(br,B,bx,bh,J,D,V,F)}function bt(a){return"\\"+bi[a]}function bu(a){return bC[a]}function bv(){}function bw(a){return bD[a]}function bx(a){return F.call(a)==N}function bA(a){var b=!1;if(!a||typeof a!="object"||bx(a))return b;var c=a.constructor;return(!bb||typeof a.toString=="function"||typeof (a+"")!="string")&&(!bR(c)||c instanceof c)?X?(by(a,function(a,c,d){return b=!B.call(d,c),!1}),b===!1):(by(a,function(a,c){b=c}),b===!1||B.call(a,b)):b}function bB(a){var b=[];return bz(a,function(a,c){b.push(c)}),b}function bE(a,b,c,d,e){if(a==null)return a;c&&(b=!1);var f=bh[typeof a];if(f){var g=F.call(a);if(!bg[g]||$&&bx(a))return a;var h=g==O;f=h||(g==T?bW(a):f)}if(!f||!b)return f?h?E.call(a):bG({},a):a;var i=a.constructor;switch(g){case P:case Q:return new i(+a);case S:case V:return new i(a);case U:return i(a.source,p.exec(a))}d||(d=[]),e||(e=[]);var j=d.length;while(j--)if(d[j]==a)return e[j];var k=h?i(a.length):{};return d.push(a),e.push(k),(h?cj:bz)(a,function(a,c){k[c]=bE(a,b,null,d,e)}),k}function bH(a){var b=[];return by(a,function(a,c){bR(a)&&b.push(c)}),b.sort()}function bI(a,b){return a?B.call(a,b):!1}function bJ(a){var b={};return bz(a,function(a,c){b[a]=c}),b}function bL(a){return a===!0||a===!1||F.call(a)==P}function bM(a){return F.call(a)==Q}function bN(a){return a?a.nodeType===1:!1}function bO(a){var b=!0;if(!a)return b;var c=F.call(a),d=a.length;return c==O||c==V||c==N||$&&bx(a)||c==T&&typeof d=="number"&&bR(a.splice)?!d:(bz(a,function(){return b=!1}),b)}function bP(a,b,c,d){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;var e=F.call(a);if(e!=F.call(b))return!1;switch(e){case P:case Q:return+a==+b;case S:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case U:case V:return a==b+""}var f=e==O||e==N;if($&&!f&&(f=bx(a))&&!bx(b))return!1;if(!f){if(a.__wrapped__||b.__wrapped__)return bP(a.__wrapped__||a,b.__wrapped__||b);if(e!=T||bb&&(typeof a.toString!="function"&&typeof (a+"")=="string"||typeof b.toString!="function"&&typeof (b+"")=="string"))return!1;var g=a.constructor,h=b.constructor;if(g!=h&&!(bR(g)&&g instanceof g&&bR(h)&&h instanceof h))return!1}c||(c=[]),d||(d=[]);var i=c.length;while(i--)if(c[i]==a)return d[i]==b;var j=-1,k=!0,l=0;c.push(a),d.push(b);if(f){l=a.length,k=l==b.length;if(k)while(l--)if(!(k=bP(a[l],b[l],c,d)))break;return k}for(var m in a)if(B.call(a,m)){l++;if(!B.call(b,m)||!bP(a[m],b[m],c,d))return!1}for(m in b)if(B.call(b,m)&&!(l--))return!1;if(W)while(++j<7){m=v[j];if(B.call(a,m)&&(!B.call(b,m)||!bP(a[m],b[m],c,d)))return!1}return!0}function bQ(a){return I(a?+a:parseFloat(a))}function bR(a){return typeof a=="function"}function bS(a){return a?bh[typeof a]:!1}function bT(a){return F.call(a)==S&&a!=+a}function bU(a){return a===null}function bV(a){return F.call(a)==S}function bX(a){return F.call(a)==U}function bY(a){return F.call(a)==V}function bZ(a){return a===b}function b_(a,b,c){var d=arguments,e=0,f=2,g=d[3],i=d[4];c!==h&&(g=[],i=[],f=d.length);while(++e<f)bz(d[e],function(b,c){var d,e,f;if(b&&((e=bK(b))||bW(b))){var j=g.length;while(j--){d=g[j]==b;if(d)break}d?a[c]=i[j]:(g.push(b),i.push(f=(f=a[c],e)?bK(f)?f:[]:bW(f)?f:{}),a[c]=b_(f,b,h,g,i))}else b!=null&&(a[c]=b)});return a}function ca(a,b,c){var d=typeof b=="function",f={};if(d)b=br(b,c);else var g=y.apply(e,arguments);return by(a,function(a,c,e){if(d?!b(a,c,e):cD(g,c,1)<0)f[c]=a}),f}function cb(a){var b=[];return bz(a,function(a,c){b.push([c,a])}),b}function cc(a,b,c){var d={};if(typeof b!="function"){var f=0,g=y.apply(e,arguments),h=g.length;while(++f<h){var i=g[f];i in a&&(d[i]=a[i])}}else b=br(b,c),by(a,function(a,c,e){b(a,c,e)&&(d[c]=a)});return d}function cd(a){var b=[];return bz(a,function(a){b.push(a)}),b}function ce(a,b){var c=a?a.length:0;return typeof c=="number"?(F.call(a)==V?a.indexOf(b):cD(a,b))>-1:cv(a,function(a){return a===b})}function cf(a,b,c){var d={};return b=br(b,c),cj(a,function(a,c,e){c=b(a,c,e),B.call(d,c)?d[c]++:d[c]=1}),d}function cg(a,b,c){var d=!0;return b=br(b,c),cj(a,function(a,c,e){return d=b(a,c,e)}),!!d}function ch(a,b,c){var d=[];return b=br(b,c),cj(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d}function ci(a,b,c){var d;return b=br(b,c),cv(a,function(a,c,e){return b(a,c,e)&&(d=a,!0)}),d}function ck(a,b,c){var d={};return b=br(b,c),cj(a,function(a,c,e){c=b(a,c,e),(B.call(d,c)?d[c]:d[c]=[]).push(a)}),d}function cl(a,b){var c=E.call(arguments,2),d=typeof b=="function",e=[];return cj(a,function(a){e.push((d?b:a[b]).apply(a,c))}),e}function cm(a,b,c){var d=-1,e=a?a.length:0,f=Array(typeof e=="number"?e:0);b=br(b,c);if(bK(a))while(++d<e)f[d]=b(a[d],d,a);else cj(a,function(a,c,e){f[++d]=b(a,c,e)});return f}function cn(a,b,c){var d=-Infinity,e=-1,f=a?a.length:0,g=d;if(b||typeof f!="number")b=br(b,c),cj(a,function(a,c,e){var f=b(a,c,e);f>d&&(d=f,g=a)});else while(++e<f)a[e]>g&&(g=a[e]);return g}function co(a,b,c){var d=Infinity,e=-1,f=a?a.length:0,g=d;if(b||typeof f!="number")b=br(b,c),cj(a,function(a,c,e){var f=b(a,c,e);f<d&&(d=f,g=a)});else while(++e<f)a[e]<g&&(g=a[e]);return g}function cp(a,b){var c=[];return cj(a,function(a){c.push(a[b])}),c}function cq(a,b,c,d){var e=arguments.length<3;return b=br(b,d),cj(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)}),c}function cr(a,b,c,d){var e=a,f=a?a.length:0,g=arguments.length<3;if(typeof f!="number"){var h=b$(a);f=h.length}else ba&&F.call(a)==V&&(e=a.split(""));return cj(a,function(a,i,j){i=h?h[--f]:--f,c=g?(g=!1,e[i]):b.call(d,c,e[i],i,j)}),c}function cs(a,b,c){return b=br(b,c),ch(a,function(a,c,d){return!b(a,c,d)})}function ct(a){var b=-1,c=Array(a?a.length:0);return cj(a,function(a){var d=z(M()*(++b+1));c[b]=c[d],c[d]=a}),c}function cu(a){var b=a?a.length:0;return typeof b=="number"?b:b$(a).length}function cv(a,b,c){var d;return b=br(b,c),cj(a,function(a,c,e){return!(d=b(a,c,e))}),!!d}function cw(a,b,c){var d=[];b=br(b,c),cj(a,function(a,c,e){d.push({criteria:b(a,c,e),index:c,value:a})});var e=d.length;d.sort(bp);while(e--)d[e]=d[e].value;return d}function cx(a){return a&&typeof a.length=="number"?(_?F.call(a)==V:typeof a=="string")?a.split(""):E.call(a):cd(a)}function cy(a,b){var c=[];return by(b,function(a,b){c.push(b)}),ch(a,function(a){var d=c.length;while(d--){var e=a[c[d]]===b[c[d]];if(!e)break}return!!e})}function cz(a){var b=-1,c=a?a.length:0,d=[];while(++b<c){var e=a[b];e&&d.push(e)}return d}function cA(a){var b=-1,c=a?a.length:0,d=y.apply(e,arguments),f=bo(d,c),g=[];while(++b<c){var h=a[b];f(h)||g.push(h)}return g}function cB(a,b,c){if(a)return b==null||c?a[0]:E.call(a,0,b)}function cC(a,b){var c=-1,d=a?a.length:0,e=[];while(++c<d){var f=a[c];bK(f)?C.apply(e,b?f:cC(f)):e.push(f)}return e}function cD(a,b,c){var d=-1,e=a?a.length:0;if(typeof c=="number")d=(c<0?K(0,e+c):c||0)-1;else if(c)return d=cL(a,b),a[d]===b?d:-1;while(++d<e)if(a[d]===b)return d;return-1}function cE(a,b,c){return a?E.call(a,0,-(b==null||c?1:b)):[]}function cF(a){var b=arguments,c=b.length,d={},e=[];return cj(a,function(a){if(cD(e,a)<0){var f=c;while(--f)if(!(d[f]||(d[f]=bo(b[f])))(a))return;e.push(a)}}),e}function cG(a,b,c){if(a){var d=a.length;return b==null||c?a[d-1]:E.call(a,-b||d)}}function cH(a,b,c){var d=a?a.length:0;typeof c=="number"&&(d=(c<0?K(0,d+c):L(c,d-1))+1);while(d--)if(a[d]===b)return d;return-1}function cI(a,b){var c=-1,d=a?a.length:0,e={};while(++c<d){var f=a[c];b?e[f]=b[c]:e[f[0]]=f[1]}return e}function cJ(a,b,c){a=+a||0,c=+c||1,b==null&&(b=a,a=0);var d=-1,e=K(0,x((b-a)/c)),f=Array(e);while(++d<e)f[d]=a,a+=c;return f}function cK(a,b,c){return a?E.call(a,b==null||c?1:b):[]}function cL(a,b,c,d){var e=0,f=a?a.length:e;c=c?br(c,d):dc,b=c(b);while(e<f){var g=e+f>>>1;c(a[g])<b?e=g+1:f=g}return e}function cM(){var a=-1,b=y.apply(e,arguments),c=b.length,d=[];while(++a<c){var f=b[a];cD(d,f)<0&&d.push(f)}return d}function cN(a,b,c,d){var e=-1,f=a?a.length:0,g=[],h=[];typeof b=="function"&&(d=c,c=b,b=!1),c=br(c,d);while(++e<f){var i=c(a[e],e,a);if(b?!e||h[h.length-1]!==i:cD(h,i)<0)h.push(i),g.push(a[e])}return g}function cO(a){var b=-1,c=a?a.length:0,d=bo(arguments,1,20),e=[];while(++b<c){var f=a[b];d(f)||e.push(f)}return e}function cP(a){var b=-1,c=a?cn(cp(arguments,"length")):0,d=Array(c);while(++b<c)d[b]=cp(arguments,b);return d}function cQ(a,b){return a<1?b():function(){if(--a<1)return b.apply(this,arguments)}}function cR(a,b){return bd||G&&arguments.length>2?G.call.apply(G,arguments):bq(a,b,E.call(arguments,2))}function cS(a){var b=arguments,c=b.length>1?0:(b=bH(a),-1),d=b.length;while(++c<d){var e=b[c];a[e]=cR(a[e],a)}return a}function cT(){var a=arguments;return function(){var b=arguments,c=a.length;while(c--)b=[a[c].apply(this,b)];return b[0]}}function cU(a,b,c){function h(){g=null,c||(e=a.apply(f,d))}var d,e,f,g;return function(){var i=c&&!g;return d=arguments,f=this,clearTimeout(g),g=setTimeout(h,b),i&&(e=a.apply(f,d)),e}}function cV(a,c){var d=E.call(arguments,2);return setTimeout(function(){a.apply(b,d)},c)}function cW(a){var c=E.call(arguments,1);return setTimeout(function(){a.apply(b,c)},1)}function cX(a,b){return bq(b,a,E.call(arguments,2))}function cY(a,b){var c={};return function(){var d=b?b.apply(this,arguments):arguments[0];return B.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}}function cZ(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}function c$(a){return bq(a,E.call(arguments,1))}function c_(a,b){function h(){g=new Date,f=null,d=a.apply(e,c)}var c,d,e,f,g=0;return function(){var i=new Date,j=b-(i-g);return c=arguments,e=this,j<=0?(clearTimeout(f),g=i,d=a.apply(e,c)):f||(f=setTimeout(h,j)),d}}function da(a,b){return function(){var c=[a];return C.apply(c,arguments),b.apply(this,c)}}function db(a){return a==null?"":(a+"").replace(t,bu)}function dc(a){return a}function dd(a){cj(bH(a),function(b){var c=bj[b]=a[b];bj.prototype[b]=function(){var a=[this.__wrapped__];C.apply(a,arguments);var b=c.apply(bj,a);return this.__chain__&&(b=new bj(b),b.__chain__=!0),b}})}function de(){return a._=j,this}function df(a,b){return a==null&&b==null&&(b=1),a=+a||0,b==null&&(b=a,a=0),a+z(M()*((+b||0)-a+1))}function dg(a,b){var c=a?a[b]:null;return bR(c)?a[b]():c}function dh(a,b,c){a||(a=""),c||(c={});var d,e,f=0,g=bj.templateSettings,h="__p += '",i=c.variable||g.variable,j=i,l=RegExp((c.escape||g.escape||s).source+"|"+(c.interpolate||g.interpolate||s).source+"|"+(c.evaluate||g.evaluate||s).source+"|$","g");a.replace(l,function(b,c,e,g,i){h+=a.slice(f,i).replace(u,bt),h+=c?"' +\n__e("+c+") +\n'":g?"';\n"+g+";\n__p += '":e?"' +\n((__t = ("+e+")) == null ? '' : __t) +\n'":"",d||(d=g||k.test(c||e)),f=i+b.length}),h+="';\n";if(!j){i="obj";if(d)h="with ("+i+") {\n"+h+"\n}\n";else{var p=RegExp("(\\(\\s*)"+i+"\\."+i+"\\b","g");h=h.replace(q,"$&"+i+".").replace(p,"$1__d")}}h=(d?h.replace(m,""):h).replace(n,"$1").replace(o,"$1;"),h="function("+i+") {\n"+(j?"":i+" || ("+i+" = {});\n")+"var __t, __p = '', __e = _.escape"+(d?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(j?"":", __d = "+i+"."+i+" || "+i)+";\n")+h+"return __p\n}";var r=bf?"\n//@ sourceURL="+(c.sourceURL||"/lodash/template/source["+w++ +"]"):"";try{e=Function("_","return "+h+r)(bj)}catch(t){throw t.source=h,t}return b?e(b):(e.source=h,e)}function di(a,b,c){a=+a||0;var d=-1,e=Array(a);while(++d<a)e[d]=b.call(c,d);return e}function dj(a){return a==null?"":(a+"").replace(l,bw)}function dk(a){var b=g++;return a?a+b:b}function dl(a){return a=new bj(a),a.__chain__=!0,a}function dm(a,b){return b(a),a}function dn(){return this.__chain__=!0,this}function dp(){return this.__wrapped__}var c=typeof exports=="object"&&exports,d=typeof global=="object"&&global;d.global===d&&(a=d);var e=[],f={},g=0,h={},i=30,j=a._,k=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,l=/&(?:amp|lt|gt|quot|#x27);/g,m=/\b__p \+= '';/g,n=/\b(__p \+=) '' \+/g,o=/(__e\(.*?\)|\b__t\)) \+\n'';/g,p=/\w*$/,q=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,r=RegExp("^"+(f.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),s=/($^)/,t=/[&<>"']/g,u=/['\n\r\t\u2028\u2029\\]/g,v=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],w=0,x=Math.ceil,y=e.concat,z=Math.floor,A=r.test(A=Object.getPrototypeOf)&&A,B=f.hasOwnProperty,C=e.push,D=f.propertyIsEnumerable,E=e.slice,F=f.toString,G=r.test(G=E.bind)&&G,H=r.test(H=Array.isArray)&&H,I=a.isFinite,J=r.test(J=Object.keys)&&J,K=Math.max,L=Math.min,M=Math.random,N="[object Arguments]",O="[object Array]",P="[object Boolean]",Q="[object Date]",R="[object Function]",S="[object Number]",T="[object Object]",U="[object RegExp]",V="[object String]",W,X,Y=(Y={0:1,length:1},e.splice.call(Y,0,1),Y[0]),Z=!0;(function(){function b(){this.x=1}var a=[];b.prototype={valueOf:1,y:1};for(var c in new b)a.push(c);for(c in arguments)Z=!c;W=!/valueOf/.test(a),X=a[0]!="x"})(1);var $=!bx(arguments),_=E.call("x")[0]!="x",ba="x"[0]+Object("x")[0]!="xx";try{var bb=({toString:0}+"",F.call(a.document||0)==T)}catch(bc){}var bd=G&&/\n|Opera/.test(G+F.call(a.opera)),be=J&&/^.+$|true/.test(J+!!a.attachEvent);try{var bf=(Function("//@")(),!a.attachEvent)}catch(bc){}var bg={};bg[N]=bg[R]=!1,bg[O]=bg[P]=bg[Q]=bg[S]=bg[T]=bg[U]=bg[V]=!0;var bh={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},bi={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};bj.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var bk=dh("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),bl={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},bm={useHas:!1,args:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",objectLoop:"result[index] = value",bottom:"  }\n}"},bn={arrayLoop:null};$&&(bx=function(a){return a?B.call(a,"callee"):!1});var by=bs(bl,bn,{useHas:!1}),bz=bs(bl,bn),bC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},bD=bJ(bC),bF=bs(bm,{objectLoop:"if (result[index] == null) "+bm.objectLoop}),bG=bs(bm),bK=H||function(a){return F.call(a)==O};bR(/x/)&&(bR=function(a){return F.call(a)==R});var bW=A?function(a){if(!a||typeof a!="object")return!1;var b=a.valueOf,c=typeof b=="function"&&(c=A(b))&&A(c);return c?a==c||A(a)==c&&!bx(a):bA(a)}:bA,b$=J?function(a){var b=typeof a;return b=="function"&&D.call(a,"prototype")?bB(a):a&&bh[b]?J(a):[]}:bB,cj=bs(bl);bj.VERSION="0.9.0",bj.after=cQ,bj.bind=cR,bj.bindAll=cS,bj.chain=dl,bj.clone=bE,bj.compact=cz,bj.compose=cT,bj.contains=ce,bj.countBy=cf,bj.debounce=cU,bj.defaults=bF,bj.defer=cW,bj.delay=cV,bj.difference=cA,bj.escape=db,bj.every=cg,bj.extend=bG,bj.filter=ch,bj.find=ci,bj.first=cB,bj.flatten=cC,bj.forEach=cj,bj.forIn=by,bj.forOwn=bz,bj.functions=bH,bj.groupBy=ck,bj.has=bI,bj.identity=dc,bj.indexOf=cD,bj.initial=cE,bj.intersection=cF,bj.invert=bJ,bj.invoke=cl,bj.isArguments=bx,bj.isArray=bK,bj.isBoolean=bL,bj.isDate=bM,bj.isElement=bN,bj.isEmpty=bO,bj.isEqual=bP,bj.isFinite=bQ,bj.isFunction=bR,bj.isNaN=bT,bj.isNull=bU,bj.isNumber=bV,bj.isObject=bS,bj.isPlainObject=bW,bj.isRegExp=bX,bj.isString=bY,bj.isUndefined=bZ,bj.keys=b$,bj.last=cG,bj.lastIndexOf=cH,bj.lateBind=cX,bj.map=cm,bj.max=cn,bj.memoize=cY,bj.merge=b_,bj.min=co,bj.mixin=dd,bj.noConflict=de,bj.object=cI,bj.omit=ca,bj.once=cZ,bj.pairs=cb,bj.partial=c$,bj.pick=cc,bj.pluck=cp,bj.random=df,bj.range=cJ,bj.reduce=cq,bj.reduceRight=cr,bj.reject=cs,bj.rest=cK,bj.result=dg,bj.shuffle=ct,bj.size=cu,bj.some=cv,bj.sortBy=cw,bj.sortedIndex=cL,bj.tap=dm,bj.template=dh,bj.throttle=c_,bj.times=di,bj.toArray=cx,bj.unescape=dj,bj.union=cM,bj.uniq=cN,bj.uniqueId=dk,bj.values=cd,bj.where=cy,bj.without=cO,bj.wrap=da,bj.zip=cP,bj.all=cg,bj.any=cv,bj.collect=cm,bj.detect=ci,bj.drop=cK,bj.each=cj,bj.foldl=cq,bj.foldr=cr,bj.head=cB,bj.include=ce,bj.inject=cq,bj.methods=bH,bj.select=ch,bj.tail=cK,bj.take=cB,bj.unique=cN,bj._iteratorTemplate=bk,dd(bj),bj.prototype.chain=dn,bj.prototype.value=dp,cj(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];bj.prototype[a]=function(){var a=this.__wrapped__;return b.apply(a,arguments),Y&&a.length===0&&delete a[0],this.__chain__&&(a=new bj(a),a.__chain__=!0),a}}),cj(["concat","join","slice"],function(a){var b=e[a];bj.prototype[a]=function(){var a=this.__wrapped__,c=b.apply(a,arguments);return this.__chain__&&(c=new bj(c),c.__chain__=!0),c}}),typeof define=="function"&&typeof define.amd=="object"&&define
.amd?(a._=bj,define(function(){return bj})):c?typeof module=="object"&&module&&module.exports==c?(module.exports=bj)._=bj:c._=bj:a._=bj}(this);var JSON;JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var a=this.math={};a.mean=a.ave=a.average=function(b,c){return a.sum(b,c)/_(b).size()},a.median=function(b){var c=(b.length+1)/2,d=a.sort(b);return d.length%2?d[c-1]:(d[c-1.5]+d[c-.5])/2},a.pow=function(a,b){if(_.isNumber(a))return Math.pow(a,b);if(_.isArray(a))return _.map(a,function(a){return _.pow(a,b)})},a.scale=function(a,b){var b=b||1,c=_.max(a);return _.map(a,function(a){return a*(b/c)})},a.slope=function(a,b){return(b[1]-a[1])/(b[0]-a[0])},a.sort=function(a){return a.sort(function(a,b){return a-b})},a.stdDeviation=a.sigma=function(a){return Math.sqrt(_(a).variance())},a.sum=function(a,b){if(_.isArray(a)&&typeof a[0]=="number")var c=a;else var b=b||"value",c=_(a).pluck(b);var d=0;for(var e=0,f=c.length;e<f;e++)d+=c[e];return d},a.transpose=function(a){var b=[];return _(a).each(function(a,c){_(a).each(function(a,d){b[d]||(b[d]=[]),b[d][c]=a})}),b},a.variance=function(a){var b=_(a).mean();return _(a).chain().map(function(a){return _(a-b).pow(2)}).mean().value()},_.mixin(a)}(),function(a){function r(a){var b=q[a]={};return j(a.split(/\s+/),function(a){b[a]=!0}),b}var b={},c=Array.prototype,d=Object.prototype,e=d.hasOwnProperty,f=d.toString,g=c.forEach,h=c.indexOf,i=c.slice,j=function(a,c,d){var f,h,i;if(!a)return;if(g&&a.forEach===g)a.forEach(c,d);else if(a.length===+a.length){for(h=0,i=a.length;h<i;h++)if(h in a&&c.call(d,a[h],h,a)===b)return}else for(f in a)if(e.call(a,f)&&c.call(d,a[f],f,a)===b)return},k=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},l=function(a){return j(i.call(arguments,1),function(b){var c;for(c in b)b[c]!==void 0&&(a[c]=b[c])}),a},m=function(a,b,c){var d;if(b){if(h)return h.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},n={};j("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){n["[object "+a+"]"]=a.toLowerCase()});var o=function(a){return a==null?String(a):n[f.call(a)]||"object"},p={},q={};p.Callbacks=function(a){a=typeof a=="string"?q[a]||r(a):l({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],k=function(j){b=a.memory&&j,c=!0,g=e||0,e=0,f=h.length,d=!0;for(;h&&g<f;g++)if(h[g].apply(j[0],j[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&k(i.shift()):b?h=[]:n.disable())},n={add:function(){if(h){var c=h.length;(function g(b){j(b,function(b){var c=o(b);c==="function"&&(!a.unique||!n.has(b))?h.push(b):b&&b.length&&c!=="string"&&g(b)})})(arguments),d?f=h.length:b&&(e=c,k(b))}return this},remove:function(){return h&&j(arguments,function(a){var b;while((b=m(a,h,b))>-1)h.splice(b,1),d&&(b<=f&&f--,b<=g&&g--)}),this},has:function(a){return m(a,h)>-1},empty:function(){return h=[],this},disable:function(){return h=i=b=undefined,this},disabled:function(){return!h},lock:function(){return i=undefined,b||n.disable(),this},locked:function(){return!i},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],h&&(!c||i)&&(d?i.push(b):k(b)),this},fire:function(){return n.fireWith(this,arguments),this},fired:function(){return!!c}};return n},p.Deferred=function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){j(b,function(b,d){var f=b[0],g=a[d];e[b[1]](k(g)?function(){var a=g.apply(this,arguments);a&&k(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return typeof a=="object"?l(a,d):d}},e={};return d.pipe=d.then,j(b,function(a,f){var g=a[2],h=a[3];d[a[1]]=g.add,h&&g.add(function(){c=h},b[f^1][2].disable,b[2][2].lock),e[a[0]]=g.fire,e[a[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},p.when=function(a){var b=0,c=i.call(arguments),d=c.length,e=d!==1||a&&k(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?i.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,j,l;if(d>1){h=new Array(d),j=new Array(d),l=new Array(d);for(;b<d;b++)c[b]&&k(c[b].promise)?c[b].promise().done(g(b,l,c)).fail(f.reject).progress(g(b,j,h)):--e}return e||f.resolveWith(l,c),f.promise()},typeof module!="undefined"&&module.exports?module.exports=p:typeof a._!="undefined"?a._.mixin(p):a._=p}(this),function(a,b){var c=a.Miso=a.Miso||{};c.Events={publish:function(a){var c=b.toArray(arguments);return c.shift(),this._events&&this._events[a]&&b.each(this._events[a],function(a){a.callback.apply(a.context||this,c)},this),this},subscribe:function(a,c,d){d=d||{},this._events=this._events||{},this._events[a]=this._events[a]||[];var e={callback:c,priority:d.priority||0,token:d.token||b.uniqueId("t"),context:d.context||this},f;return b.each(this._events[a],function(a,c){if(!b.isUndefined(f))return;a.priority<=e.priority&&(f=c)}),this._events[a].splice(f,0,e),e.token},subscribeOnce:function(a,c,d){this._events=this._events||{},d=d||{};var e=this;return typeof d.token=="undefined"&&(d.token=b.uniqueId("t")),this.subscribe(a,function(){e.unsubscribe(a,{token:d.token}),c.apply(this,arguments)},d)},unsubscribe:function(a,c){return b.isUndefined(this._events[a])?this:(b.isFunction(c)?this._events[a]=b.reject(this._events[a],function(a){return a.callback===c}):b.isString(c)?this._events[a]=b.reject(this._events[a],function(a){return a.token===c}):this._events[a]=[],this)}}}(this,_),function(a){a.Miso=a.Miso||{},a.Miso.Dataset=function(a){a=a||{},this.length=0,this._columns=[],this._columnPositionByName={},this._computedColumns=[],this._initialize(a)}}(this),function(a,b){var c=a.Miso||(a.Miso={}),d=a.Miso.Dataset;d.Column=function(a){return b.extend(this,a),this._id=a.id||b.uniqueId(),this.data=a.data||[],this},b.extend(d.Column.prototype,{toNumeric:function(a){return d.types[this.type].numeric(a)},numericAt:function(a){return this.toNumeric(this.data[a])},coerce:function(){this.data=b.map(this.data,function(a){return d.types[this.type].coerce(a,this)},this)},compute:function(a,b){if(this.func){var c=this.func(a);return typeof b!="undefined"?this.data[b]=c:this.data.push(c),c}},isComputed:function(){return!b.isUndefined(this.func)},_sum:function(){return b.sum(this.data)},_mean:function(){var a=0;for(var b=0;b<this.data.length;b++)a+=this.numericAt(b);return a/=this.data.length,d.types[this.type].coerce(a,this)},_median:function(){return d.types[this.type].coerce(b.median(this.data),this)},_max:function(){var a=-Infinity;for(var b=0;b<this.data.length;b++)this.data[b]!==null&&d.types[this.type].compare(this.data[b],a)>0&&(a=this.numericAt(b));return d.types[this.type].coerce(a,this)},_min:function(){var a=Infinity;for(var b=0;b<this.data.length;b++)this.data[b]!==null&&d.types[this.type].compare(this.data[b],a)<0&&(a=this.numericAt(b));return d.types[this.type].coerce(a,this)}}),d.DataView=function(a){if(typeof a!="undefined"){a=a||(a={});if(b.isUndefined(a.parent))throw new Error("A view must have a parent specified.");this.parent=a.parent,this._initialize(a)}},b.extend(d.DataView.prototype,{_initialize:function(a){this.parent.syncable===!0&&(b.extend(this,c.Events),this.syncable=!0),this.idAttribute=this.parent.idAttribute,this.filter={},this.filter.columns=b.bind(this._columnFilter(a.filter.columns||undefined),this),this.filter.rows=b.bind(this._rowFilter(a.filter.rows||undefined),this),this._columns=this._selectData(),d.Builder.cacheColumns(this),d.Builder.cacheRows(this),this.syncable&&this.parent.subscribe("change",this._sync,{context:this})},_sync:function(a){var c=a.deltas,e=null;b.each(c,function(c,f){var g=this._rowPositionById[c[this.idAttribute]];if(typeof g=="undefined"&&d.Event.isAdd(c))this.filter.rows&&this.filter.rows(c.changed)&&(this._add(c.changed),e="add");else{if(g==="undefined")return;b.each(c.changed,function(a,c){var d=this._columnPositionByName[c];if(b.isUndefined(d))return;this._columns[d].data[g]=a,e="update"},this)}var h=this.rowByPosition(g);if(d.Event.isRemove(c)||this.filter.row&&!this.filter.row(h)){var i={old:this.rowByPosition(g),changed:{}};i[this.idAttribute]=c[this.idAttribute],a.deltas.splice(f,1,i),this._remove(g),e="delete"}},this),this.syncable&&(this.publish(e,a),this.publish("change",a))},where:function(a,c){return c=c||{},c.filter=c.filter||{},b.isFunction(a)?c.filter.rows=a:c.filter=a,c.parent=this,new d.DataView(c)},_selectData:function(){var a=[];return b.each(this.parent._columns,function(b){this.filter.columns(b)&&a.push(new d.Column({name:b.name,data:[],type:b.type,_id:b._id}))},this),this.parent.each(function(b){if(!this.filter.rows(b))return;for(var c=0;c<a.length;c++)a[c].data.push(b[a[c].name])},this),a},_columnFilter:function(a){var c;return b.isUndefined(a)?c=function(){return!0}:(b.isString(a)&&(a=[a]),a.push(this.idAttribute),c=function(c){return b.indexOf(a,c.name)===-1?!1:!0}),c},_rowFilter:function(a){var c;return b.isNumber(a)&&(a=[a]),b.isUndefined(a)?c=function(){return!0}:b.isFunction(a)?c=a:c=b.bind(function(c){return b.indexOf(a,c[this.idAttribute])===-1?!1:!0},this),c},column:function(a){return this._column(a)},_column:function(a){if(b.isUndefined(this._columnPositionByName))return undefined;var c=this._columnPositionByName[a];return this._columns[c]},columns:function(a){return new d.DataView({filter:{columns:a},parent:this})},columnNames:function(){var a=b.pluck(this._columns,"name");return b.reject(a,function(a){return a===this.idAttribute||a==="_oids"},this)},hasColumn:function(a){return!b.isUndefined(this._columnPositionByName[a])},each:function(a,b){for(var c=0;c<this.length;c++)a.apply(b||this,[this.rowByPosition(c),c])},reverseEach:function(a,b){for(var c=this.length-1;c>=0;c--)a.apply(b||this,[this.rowByPosition(c),c])},eachColumn:function(a,b){var c=this.columnNames();for(var d=0;d<c.length;d++)a.apply(b||this,[c[d],this.column(c[d]),d])},rowByPosition:function(a){return this._row(a)},rowById:function(a){return this._row(this._rowPositionById[a])},_row:function(a){var c={};return b.each(this._columns,function(b){c[b.name]=b.data[a]}),c},_remove:function(a){var c=this._rowPositionById[a];return b.each(this._columns,function(a){a.data.splice(c,1)}),delete this._rowPositionById[a],this._rowIdByPosition.splice(c,1),this.length--,this},_add:function(a){b.each(a,function(c,e){var f=this.column(e);if(f.isComputed())throw"You're trying to update a computed column. Those get computed!";if(typeof f!="undefined"){var g=d.types[f.type];if(!f.force&&!g.test(a[f.name],f))throw"incorrect value '"+a[f.name]+"' of type "+d.typeOf(a[f.name],f)+" passed to column '"+f.name+"' with type "+f.type;b.isUndefined(f.before)||(a[f.name]=f.before(a[f.name])),a[f.name]=g.coerce(a[f.name],f)}},this),this._computedColumns&&b.each(this._computedColumns,function(b){var c=b.compute(a);a[b.name]=c});if(b.isUndefined(this.comparator)){b.each(this._columns,function(c){c.isComputed()||c.data.push(!b.isUndefined(a[c.name])&&!b.isNull(a[c.name])?a[c.name]:null)}),this.length++,this._rowIdByPosition=this._rowIdByPosition||(this._rowIdByPosition=[]),this._rowPositionById=this._rowPositionById||(this._rowPositionById={});if(typeof this._rowPositionById[a[this.idAttribute]]!="undefined")throw"The id "+a[this.idAttribute]+" is not unique. The "+this.idAttribute+" column must be unique";this._rowPositionById[a[this.idAttribute]]=this._rowIdByPosition.length,this._rowIdByPosition.push(a[this.idAttribute])}else{var c=function(a,b,c){Array.prototype.splice.apply(c,[a,0].concat(b))},e;this.length++;for(e=0;e<this.length;e++){var f=this.rowByPosition(e);if(b.isUndefined(f[this.idAttribute])||this.comparator(a,f)<0){b.each(this._columns,function(b){c(e,a[b.name]?a[b.name]:null,b.data)});break}}this._rowIdByPosition=[],this._rowPositionById={},this.each(function(a,b){this._rowIdByPosition.push(a[this.idAttribute]),this._rowPositionById[a[this.idAttribute]]=b},this)}return this},rows:function(a){return new d.DataView({filter:{rows:a},parent:this})},sort:function(a){var c={},d=[];b.isFunction(a)?c.comparator=a:c=a||{};if(c.comparator)this.comparator=c.comparator;else if(b.isUndefined(this.comparator))throw new Error("Cannot sort without this.comparator.");var e,f,g;for(e=0;e<this.length;e++)d[e]=this._row(e);d.sort(this.comparator),e=d.length;while(e--){g=d[e],this._rowIdByPosition[e]=g[this.idAttribute],this._rowPositionById[g[this.idAttribute]]=e,f=this._columns.length;while(f--){var h=this._columns[f];h.data[e]=g[h.name]}}return this.syncable&&!c.silent&&this.publish("sort"),this},toJSON:function(){var a=[];for(var b=0;b<this.length;b++)a.push(this.rowByPosition(b));return a}})}(this,_),function(a,b,c){var d=a.Miso||(a.Miso={}),e=a.Miso.Dataset;e.prototype=new e.DataView,b.extend(e.prototype,{_initialize:function(a){a.sync===!0&&(b.extend(this,d.Events),this.syncable=!0),this.idAttribute=a.idAttribute||"_id",this.importer=a.importer||null,this.parser=a.parser||e.Parsers.Obj,b.isUndefined(a.parser)&&(a.strict?this.parser=e.Parsers.Strict:a.delimiter&&(this.parser=e.Parsers.Delimited)),this.importer===null&&(a.url?a.interval?(this.importer=e.Importers.Polling,this.interval=a.interval):this.importer=e.Importers.Remote:this.importer=e.Importers.Local),this.parser=new this.parser(a),this.parser instanceof e.Parsers.Delimited&&(a.dataType="text"),this.importer=new this.importer(a),a.comparator&&(this.comparator=a.comparator),a.ready&&(this.ready=a.ready),a.resetOnFetch&&(this.resetOnFetch=a.resetOnFetch),a.uniqueAgainst&&(this.uniqueAgainst=a.uniqueAgainst),b.isUndefined(a.data)&&b.isUndefined(a.url)&&this._addIdColumn(),a.deferred?this.deferred=a.deferred:this.deferred=new b.Deferred,a.columns&&this.addColumns(a.columns)},fetch:function(a){a=a||{};var c=this.deferred;if(b.isNull(this.importer))throw"No importer defined";return this.importer.fetch({success:b.bind(function(b){try{this._apply(b)}catch(d){if(!a.error)throw d;a.error.call(this,d)}this.comparator&&this.sort(),this.ready&&this.ready.call(this),a.success&&a.success.call(this),c.resolveWith(this,[this])},this),error:b.bind(function(b){a.error&&a.error.call(this,b),c.reject(b)},this)}),c.promise()},_applications:{againstColumn:function(a){var c=[],d=b.keys(a),f,g=this.uniqueAgainst,h=this.column(g),i=[],j=[],k=[];b.each(a[g],function(c,d){var f=h.data.indexOf(e.types[h.type].coerce(c)),g={};b.each(a,function(a,b){g[b]=a[d]}),f===-1?i.push(g):(j.push(g),g[this.idAttribute]=this.rowById(this.column(this.idAttribute).data[f])[this.idAttribute],this.update(g))},this),i.length>0&&this.add(i)},blind:function(a){var c,d,e=[],f,g=b.keys(a),h=b.max(b.map(g,function(b){return a[b].length},this));for(var i=0;i<h;i++){f={};for(var j=0;j<g.length;j++)f[g[j]]=a[g[j]][i];e.push(f)}this.add(e)}},_apply:function(a){var c=this.parser.parse(a);if(!this.fetched)this._addIdColumn(),this.addColumns(b.map(c.columns,function(a){return{name:a}})),e.Builder.detectColumnTypes(this,c.data),this._applications.blind.call(this,c.data),this.fetched=!0;else if(this.resetOnFetch)this.reset(),this._applications.blind.call(this,c.data);else if(this.uniqueAgainst){if(!this.hasColumn(this.uniqueAgainst))throw new Error("You requested a unique add against a column that doesn't exist.");this._applications.againstColumn.call(this,c.data)}else this._applications.blind.call(this,c.data);e.Builder.cacheRows(this)},addColumns:function(a){b.each(a,function(a){this.addColumn(a)},this)},addComputedColumn:function(a,c,d){if(!b.isUndefined(this.column(a)))throw"There is already a column by this name.";if(typeof e.types[c]=="undefined")throw"The type "+c+" doesn't exist";var f=new e.Column({name:a,type:c,func:b.bind(d,this)});return this._columns.push(f),this._computedColumns.push(f),this._columnPositionByName[f.name]=this._columns.length-1,this.length>0&&this.each(function(a,b){f.compute(a,b)},this),f},addColumn:function(a){return b.isUndefined(this.column(a.name))?(a=new e.Column(a),this._columns.push(a),this._columnPositionByName[a.name]=this._columns.length-1,a):!1},_addIdColumn:function(a){if(!b.isUndefined(this.column(this.idAttribute)))return;var c=[];a&&a>0&&b.times(a,function(){c.push(b.uniqueId())});var d=this.addColumn({name:this.idAttribute,data:c});this.idAttribute==="_id"&&(d.type="number");if(this._columnPositionByName[this.idAttribute]!==0){var e=this._columnPositionByName[this.idAttribute];this._columns.splice(e,1),this._columns.unshift(d),this._columnPositionByName[this.idAttribute]=0,b.each(this._columnPositionByName,function(a,b){b!==this.idAttribute&&this._columnPositionByName[b]<e&&this._columnPositionByName[b]++},this)}},add:function(a,c){c=c||{},b.isArray(a)||(a=[a]);var d=[];b.each(a,function(a){a[this.idAttribute]||(a[this.idAttribute]=b.uniqueId()),this._add(a,c),this.syncable&&!c.silent&&d.push({changed:a})},this);if(this.syncable&&!c.silent){var f=e.Events._buildEvent(d,this);this.publish("add",f),this.publish("change",f)}return this},remove:function(a,c){a=this._rowFilter(a);var d=[],f=[];this.each(function(b,c){a(b)&&(f.push(b[this.idAttribute]),d.push({old:b}))}),b.each(f,function(a){this._remove(a)},this);if(this.syncable&&(!c||!c.silent)){var g=e.Events._buildEvent(d,this);this.publish("remove",g),this.publish("change",g)}},_arrayUpdate:function(a){var c=[];return b.each(a,function(a){var d={old:{},changed:{}};d[this.idAttribute]=a[this.idAttribute];var f=this._rowPositionById[a[this.idAttribute]];b.each(a,function(a,c){var g=this._columns[this._columnPositionByName[c]],h=e.types[g.type];if(g.name===this.idAttribute&&g.data[f]!==a)throw"You can't update the id column";if(typeof g=="undefined")throw"column "+c+" not found!";if(!h.test(a,g))throw"Value is incorrect type";if(this._computedColumns[g.name])return;a=h.coerce(a,g),b.isUndefined(g.before)||(a=g.before(a)),g.data[f]!==a&&(d.old[c]=g.data[f],g.data[f]=a,d.changed[c]=a)},this),typeof this._computedColumns!="undefined"&&b.each(this._computedColumns,function(a){var c=b.extend({},this._row(f)),e=c[a.name],g=a.compute(c,f);e!==g&&(d.old[a.name]=e,a.data[f]=g,d.changed[a.name]=g)},this),b.keys(d.changed).length>0&&c.push(d)},this),c},_functionUpdate:function(a){var b=[];for(var c=0;c<this.length;c++){var d=a(this.rowByPosition(c));d!==!1&&b.push(d)}return this._arrayUpdate(b)},update:function(a,c){var d;if(b.isFunction(a))d=this._functionUpdate(a);else{var f=b.isArray(a)?a:[a];d=this._arrayUpdate(f)}if(this.syncable&&(!c||!c.silent)){var g=e.Events._buildEvent(d,this);this.publish("update",g),this.publish("change",g)}return this},reset:function(a){b.each(this._columns,function(a){a.data=[]}),this.length=0,this.syncable&&(!a||!a.silent)&&this.publish("reset")}})}(this,_,moment),function(a,b){var c=a.Miso.Dataset;c.typeOf=function(a,d){var e=b.keys(c.types),f;return e.push(e.splice(b.indexOf(e,"string"),1)[0]),e.push(e.splice(b.indexOf(e,"mixed"),1)[0]),f=b.find(e,function(b){return c.types[b].test(a,d)}),f=b.isUndefined(f)?"string":f,f},c.types={mixed:{name:"mixed",coerce:function(a){return b.isNull(a)||typeof a=="undefined"||b.isNaN(a)?null:a},test:function(){return!0},compare:function(a,c){if(b.isEqual(a,c))return 0;if(a<c)return-1;if(a>c)return 1},numeric:function(a){return a===null||b.isNaN(+a)?null:+a}},string:{name:"string",coerce:function(a){return b.isNaN(a)||a===null||typeof a=="undefined"?null:a.toString()},test:function(a){return a===null||typeof a=="undefined"||typeof a=="string"},compare:function(a,b){return a==null&&b!=null?-1:a!=null&&b==null?1:a<b?-1:a>b?1:0},numeric:function(a){return b.isNaN(+a)||a===null?null:b.isNumber(+a)?+a:null}},"boolean":{name:"boolean",regexp:/^(true|false)$/,coerce:function(a){return b.isNaN(a)||a===null||typeof a=="undefined"?null:a==="false"?!1:Boolean(a)},test:function(a){return a===null||typeof a=="undefined"||typeof a=="boolean"||this.regexp.test(a)?!0:!1},compare:function(a,b){return a==null&&b!=null?-1:a!=null&&b==null?1:a==null&&b==null?0:a===b?0:a<b?-1:1},numeric:function(a){return a===null||b.isNaN(a)?null:a?1:0}},number:{name:"number",regexp:/^\s*[\-\.]?[0-9]+([\.][0-9]+)?\s*$/,coerce:function(a){var c=+a;return b.isNull(a)||typeof a=="undefined"||b.isNaN(c)?null:c},test:function(a){return a===null||typeof a=="undefined"||typeof a=="number"||this.regexp.test(a)?!0:!1},compare:function(a,b){return a==null&&b!=null?-1:a!=null&&b==null?1:a==null&&b==null?0:a===b?0:a<b?-1:1},numeric:function(a){return b.isNaN(a)||a===null?null:a}},time:{name:"time",format:"DD/MM/YYYY",_formatLookup:[["DD","\\d{2}"],["D","\\d{1}|\\d{2}"],["MM","\\d{2}"],["M","\\d{1}|\\d{2}"],["YYYY","\\d{4}"],["YY","\\d{2}"],["A","[AM|PM]"],["hh","\\d{2}"],["h","\\d{1}|\\d{2}"],["mm","\\d{2}"],["m","\\d{1}|\\d{2}"],["ss","\\d{2}"],["s","\\d{1}|\\d{2}"],["ZZ","[-|+]\\d{4}"],["Z","[-|+]\\d{2}:\\d{2}"]],_regexpTable:{},_regexp:function(a){if(this._regexpTable[a])return new RegExp(this._regexpTable[a],"g");var c=a;return b.each(this._formatLookup,function(a){c=c.replace(a[0],a[1])},this),c=c.split("/").join("\\/"),this._regexpTable[a]=c,new RegExp(this._regexpTable[a],"g")},coerce:function(a,c){c=c||{};if(b.isNull(a)||typeof a=="undefined"||b.isNaN(a))return null;if(b.isString(a)){var d=c.format||this.format;return moment(a,d)}return b.isNumber(a)?moment(a):a},test:function(a,c){c=c||{};if(a===null||typeof a=="undefined")return!0;if(b.isString(a)){var d=c.format||this.format,e=this._regexp(d);return e.test(a)}return!0},compare:function(a,b){return a<b?-1:a>b?1:0},numeric:function(a){return b.isNaN(a)||a===null?null:a.valueOf()}}}}(this,_),function(a,b){var c=a.Miso.Dataset;c.Event=function(a,c){b.isArray(a)||(a=[a]),this.deltas=a,this.dataset=c||null},b.extend(c.Event.prototype,{affectedColumns:function(){var a=[];return b.each(this.deltas,function(c){c.old=c.old||[],c.changed=c.changed||[],a=b.chain(a).union(b.keys(c.old),b.keys(c.changed)).reject(function(a){return a===this.dataset.idAttribute},this).value()},this),a}}),b.extend(c.Event,{isRemove:function(a){return b.isUndefined(a.changed)||b.keys(a.changed).length===0?!0:!1},isAdd:function(a){return b.isUndefined(a.old)||b.keys(a.old).length===0?!0:!1},isUpdate:function(a){return!this.isRemove(a)&&!this.isAdd(a)?!0:!1}}),c.Events={},c.Events._buildEvent=function(a,b){return new c.Event(a,b)}}(this,_),function(a,b){var c=a.Miso.Dataset;c.Builder={detectColumnType:function(a,d){var e=b.inject(d.slice(0,5),function(a,d){var e=c.typeOf(d);return d!==""&&a.indexOf(e)===-1&&!b.isNull(d)&&a.push(e),a},[]);return e.length===1?a.type=e[0]:a.type="mixed",a},detectColumnTypes:function(a,d){b.each(d,function(b,d){var e=a.column(d);if(e.type){e.force=!0;return}c.Builder.detectColumnType(e,b)},this)},cacheRows:function(a){c.Builder.clearRowCache(a),b.each(a._columns[a._columnPositionByName[a.idAttribute]].data,function(b,c){a._rowPositionById[b]=c,a._rowIdByPosition.push(b)},a);var d=b.uniq(b.map(a._columns,function(a){return a.data.length}));if(d.length>1)throw new Error("Row lengths need to be the same. Empty values should be set to null."+b.map(a._columns,function(a){return a.data+"|||"}));a.length=d[0]},clearRowCache:function(a){a._rowPositionById={},a._rowIdByPosition=[]},cacheColumns:function(a){a._columnPositionByName={},b.each(a._columns,function(b,c){a._columnPositionByName[b.name]=c})}},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1})}(this,_),function(a,b){var c=a.Miso||(a.Miso={}),d=a.Miso.Dataset;d.Product=function(a){a=a||{},this.func=a.func;if(a.columns){var c=a.columns;b.isArray(a.columns)&&(c=a.columns[0]),this.valuetype=c.type,this.numeric=function(){return c.toNumeric(this.value)}}return this.func({silent:!0}),this},b.extend(d.Product.prototype,c.Events,{val:function(){return this.value},type:function(){return this.valuetype},_sync:function(a){this.func()},_buildDelta:function(a,b){return{old:a,changed:b}}}),d.Product.define=function(a){return function(c,e){e=e||{};var f=this._findColumns(c),g=this;e.type=e.type||f[0].type,e.typeOptions=e.typeOptions||f[0].typeOptions;var h=function(){var b=a.call(g,f,e);return d.types[e.type].coerce(b,e.typeOptions)};if(this.syncable){var i=new d.Product({columns:f,func:function(a){a=a||{};var c=this._buildDelta(this.value,h.call(g));this.value=c.changed;if(g.syncable){var e=d.Events._buildEvent(c,this);!b.isUndefined(c.old)&&!a.silent&&c.old!==c.changed&&this.publish("change",e)}}});return this.subscribe("change",i._sync,{context:i}),i}return h.call(g)}},b.extend(d.DataView.prototype,{_findColumns:function(a){var c=[];return b.isUndefined(a)&&(a=this.columnNames()),a=b.isArray(a)?a:[a],b.each(a,function(a){a=this._columns[this._columnPositionByName[a]],c.push(a)},this),c},sum:d.Product.define(function(a,c){return b.each(a,function(a){if(a.type===d.types.time.name)throw new Error("Can't sum up time")}),b.sum(b.map(a,function(a){return a._sum()}))}),max:d.Product.define(function(a,c){return b.max(b.map(a,function(a){return a._max()}))}),min:d.Product.define(function(a,c){return b.min(b.map(a,function(a){return a._min()}))}),mean:d.Product.define(function(a,c){var e=[];b.each(a,function(a){e.push(a.data)}),e=b.flatten(e);var f=a[0].type;return e=b.map(e,function(a){return d.types[f].numeric(a)}),b.mean(e)})})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Importers=function(a,b){},c.Importers.prototype.extract=function(a){return a=b.clone(a),a}}(this,_),function(a,b){var c=a.Miso.Dataset;c.Importers.Local=function(a){a=a||{},this.data=a.data||null,this.extract=a.extract||this.extract},b.extend(c.Importers.Local.prototype,c.Importers.prototype,{fetch:function(a){var b=a.data?a.data:this.data;a.success(this.extract(b))}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Importers.Remote=function(a){a=a||{},this._url=a.url,this.extract=a.extract||this.extract,this.params={type:"GET",url:b.isFunction(this._url)?b.bind(this._url,this):this._url,dataType:a.dataType?a.dataType:a.jsonp?"jsonp":"json",callback:a.callback}},b.extend(c.Importers.Remote.prototype,c.Importers.prototype,{fetch:function(a){var d=b.bind(function(b){a.success(this.extract(b))},this);this.callback&&(window[this.callback]=d),c.Xhr(b.extend(this.params,{success:this.callback?this.callback:d,error:a.error}))}});var d={url:"",data:"",dataType:"",success:function(){},type:"GET",async:!0,xhr:function(){return a.ActiveXObject?new a.ActiveXObject("Microsoft.XMLHTTP"):new a.XMLHttpRequest}},e=/\?/;c.Xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;var f=b.isFunction(a.url)?a.url():a.url;if(!(!a.dataType||a.dataType!=="jsonp"&&a.dataType!=="script")){c.Xhr.getJSONP(f,a.success,a.dataType==="script",a.error,a.callback);return}var g=b.extend({},d,a,{url:f});g.ajax=g.xhr();if(g.ajax)return g.type==="GET"&&g.data&&(g.url+=(e.test(g.url)?"&":"?")+g.data,g.data=null),g.ajax.open(g.type,g.url,g.async),g.ajax.send(g.data||null),c.Xhr.httpData(g)},c.Xhr.getJSONP=function(a,c,d,e,f){if(d){var g=document.querySelectorAll('script[src="'+a+'"]');if(g.length){c&&c(!0);return}}var h=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script"),j=a.split("?")[1],k=!1,l=[],m;j&&!d&&(l=j.split("&")),l.length&&(m=l[l.length-1].split("="));if(!f){var n=b.uniqueId("callback");f=l.length?m[1]?m[1]:n:n}!j&&!d&&(a+="?");if(!j||!/callback/.test(j))j&&(a+="&"),a+="callback="+f;f&&!d&&(!window[f]||(f=f+ +(new Date)+b.uniqueId()),window[f]=function(a){c&&c(a),k=!0},m&&(a=a.replace(m.join("="),m[0]+"="+f))),i.onload=i.onreadystatechange=function(){if(!i.readyState||/loaded|complete/.test(i.readyState)){d&&c&&c();if(k){try{delete window[f]}catch(a){window[f]=void 0}h.removeChild(i)}}},i.onerror=function(a){e&&e.call(null,a)},i.src=a,h.insertBefore(i,h.firstChild);return},c.Xhr.httpData=function(a){var b,c=null,d;return d=function(){if(a.ajax.readyState===4){try{c=JSON.parse(a.ajax.responseText)}catch(d){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:c},a.dataType&&(b=b[a.dataType]),/(2..)/.test(a.ajax.status)?a.success.call(a.ajax,b):a.error&&a.error.call(null,a.ajax.statusText)}},a.ajax.readyState===4?d():a.ajax.onreadystatechange=d,b}}(this,_),function(a,b){var c=a.Miso.Dataset;c.Importers.Polling=function(a){a=a||{},this.interval=a.interval||1e3,this._def=null,c.Importers.Remote.apply(this,[a])},b.extend(c.Importers.Polling.prototype,c.Importers.Remote.prototype,{fetch:function(d){this._def===null&&(this._def=b.Deferred(),this.success_callback=b.bind(function(a){d.success(this.extract(a)),this._def.resolve(this)},this),this.error_callback=b.bind(function(a){d.error(a),this._def.reject(a)},this)),b.when(this._def.promise()).then(function(a){var c=b.bind(function(){this.fetch({success:this.success_callback,error:this.error_callback})},a);a._timeout=setTimeout(c,a.interval),a._def=b.Deferred()}),c.Xhr(b.extend(this.params,{success:this.success_callback,error:this.error_callback})),a.imp=this},stop:function(){this._def!==null&&this._def.reject(),typeof this._timeout!="undefined"&&clearTimeout(this._timeout)},start:function(){this._def!==null&&(this._def=b.Deferred(),this.fetch())}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Importers.GoogleSpreadsheet=function(a){a=a||{};if(a.url)a.url=a.url;else{if(b.isUndefined(a.key))throw new Error("Set options 'key' properties to point to your google document.");a.fast?(a.url="https://spreadsheets.google.com/tq?key="+a.key,typeof a.sheetName=="undefined"&&(a.sheetName="Sheet1"),a.url+="&sheet="+a.sheetName,this.callback="misodsgs"+(new Date).getTime(),a.url+="&tqx=version:0.6;responseHandler:"+this.callback,a.url+=";reqId:0;out:json&tq&_=1335871249558#",delete a.sheetName):a.url="https://spreadsheets.google.com/feeds/cells/"+
a.key+"/"+a.worksheet+"/public/basic?alt=json-in-script&callback=",delete a.key}return this.params={type:"GET",url:a.url,dataType:"jsonp"},this},b.extend(c.Importers.GoogleSpreadsheet.prototype,c.Importers.Remote.prototype)}(this,_),function(a,b){var c=a.Miso.Dataset;c.Parsers=function(a){this.options=a||{}},b.extend(c.Parsers.prototype,{parse:function(){}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Parsers.Strict=function(a){this.options=a||{}},b.extend(c.Parsers.Strict.prototype,c.Parsers.prototype,{parse:function(a){var c={},d=[];return b.each(a.columns,function(a){if(d.indexOf(a.name)!==-1)throw new Error('You have more than one column named "'+a.name+'"');d.push(a.name),c[a.name]=a.data}),{columns:d,data:c}}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Parsers.Obj=c.Parsers,b.extend(c.Parsers.Obj.prototype,c.Parsers.prototype,{parse:function(a){var c=b.keys(a[0]),d={};return b.each(c,function(a){d[a]=[]}),b.each(c,function(c){b.times(a.length,function(b){d[c].push(a[b][c])})}),{columns:c,data:d}}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Parsers.GoogleSpreadsheet=function(a){this.fast=a.fast||!1},b.extend(c.Parsers.GoogleSpreadsheet.prototype,c.Parsers.prototype,{parse:function(a){var c=[],d=[],e={},f;if(typeof a.status!="undefined"&&a.status==="error")throw new Error("You can't use the fast importer for this url. Disable the fast flag");if(this.fast){c=b.pluck(a.table.cols,"label");if(b.unique(c).length<c.length){var g="";throw b.inject(c,function(a,b){return a[b]=a[b]+1||1,a[b]>1&&(g=b),a},{}),new Error('You have more than one column named "'+g+'"')}b.each(a.table.rows,function(a){a=a.c;for(f=0;f<a.length;f++)d[f]=d[f]||[],a[f].v===""?d[f].push(null):d[f].push(a[f].v)}),b.each(c,function(a,b){e[a]=d[b]})}else{var h=/([A-Z]+)(\d+)/,i={};b.each(a.feed.entry,function(a){var b=h.exec(a.title.$t),e=b[1],f=parseInt(b[2],10);if(f===1){if(c.indexOf(a.content.$t)!==-1)throw new Error('You have more than one column named "'+a.content.$t+'"');i[e]=d.length,c[i[e]]=a.content.$t,d[i[e]]=[]}else{var g=i[e];d[g][f-1]=a.content.$t}},this),b.each(d,function(a,f){a.length=b.max(b.pluck(d,"length")),a.splice(0,1);for(var g=0;g<a.length;g++)if(b.isUndefined(a[g])||a[g]==="")a[g]=null;e[c[f]]=a})}return{columns:c,data:e}}})}(this,_),function(a,b){var c=a.Miso.Dataset;c.Parsers.Delimited=function(a){a=a||{},this.delimiter=a.delimiter||",",this.skipRows=a.skipRows||0,this.emptyValue=a.emptyValue||null,this.__delimiterPatterns=new RegExp("(\\"+this.delimiter+"|\\r?\\n|\\r|^)"+'(?:"([^"]*(?:""[^"]*)*)"|'+'([^"\\'+this.delimiter+"\\r\\n]*))","gi")},typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),b.extend(c.Parsers.Delimited.prototype,c.Parsers.prototype,{parse:function(a){var c=[],d={},e={},f=function(a){e[a]||(e[a]=0);var b=a+e[a];return e[a]+=1,b},g=function(a,e,g,h,i){g=g||",";var j=null,k=0,l=!1,m=-1,n=0;try{e=e.replace(/\s+$/,"").replace(/^[\r|\n|\s]+[\r|\n]/,"\n");if(h>0){var o=0,p=0,q=e.length;while(o<h&&p<q)/\n|\r|\r\n/.test(e.charAt(p))&&o++,p++;e=e.slice(p,q)}function r(a){var e=a[1];if(e.length&&e!==g){n++;if(m<k-1)throw n--,new Error("Not enough items in row");l=!0,m=0}else l||k++,m++;var h=null;a[2]?h=a[2].replace(new RegExp('""',"g"),'"'):h=a[3];if(l){h===""&&(h=i);if(typeof d[c[m]]=="undefined")throw new Error("Too many items in row");d[c[m]].push(h)}else{var j=function(a){var b=f(a);while(c.indexOf(b)!==-1)b=f(a);return b};if(b.isUndefined(h)||h==="")h="X";c.indexOf(h)!==-1&&(h=j(h)),c.push(h),d[h]=[]}}(new RegExp("^"+g)).test(e)&&r(["","",undefined,""]);while(j=a.exec(e))r(j)}catch(s){throw new Error("Error while parsing delimited data on row "+n+". Message: "+s.message)}return{columns:c,data:d}};return g(this.__delimiterPatterns,a,this.delimiter,this.skipRows,this.emptyValue)}})}(this,_),function(a,b){var c=a.Miso||(a.Miso={}),d=c.Dataset;d.Derived=function(a){a=a||{},d.call(this),this.parent=a.parent,this.idAttribute="_id",this.method=a.method,this._addIdColumn(),this.addColumn({name:"_oids",type:"mixed"}),this.parent.syncable&&(b.extend(this,c.Events),this.syncable=!0,this.parent.subscribe("change",this._sync,{context:this}))},d.Derived.prototype=new d,b.extend(d.Derived.prototype,{_sync:function(){this.func.call(this.args),this.publish("change")}}),b.extend(d.DataView.prototype,{movingAverage:function(a,c,e){e=e||{};var f=new d.Derived({parent:this,method:e.method||b.mean,size:c,args:arguments});this.eachColumn(function(a){if(a===this.idAttribute)throw"You can't compute a moving average on the id column";f.addColumn({name:a,type:this.column(a).type,data:[]})},this),d.Builder.cacheColumns(f);var g=function(){typeof a=="string"&&(a=[a]),this.column(this.idAttribute).data=this.parent.column(this.parent.idAttribute).data.slice(c-1,this.parent.length),this.eachColumn(function(d,e){a.indexOf(d)===-1&&d!=="_oids"?e.data=this.parent.column(d).data.slice(c-1,this.parent.length):e.data=b.movingAvg(this.parent.column(d).data,c,this.method)},this),this.length=this.parent.length-c+1;var e=this.column("_oids");e.data=[];for(var f=0;f<this.length;f++)e.data.push(this.parent.column(this.parent.idAttribute).data.slice(f,f+c));return d.Builder.cacheRows(this),this};return f.func=b.bind(g,f),f.func.call(f.args)},countBy:function(a,c){function k(a,b,c){var e;for(e=0;e<a.length;e++)if(d.types[c].compare(a[e],b)===0)return e;return-1}c=c||{};var e=new d.Derived({parent:this,method:b.sum,args:arguments}),f=this.column(a);e.addColumn({name:a,type:f.type}),e.addColumn({name:"count",type:"number"}),e.addColumn({name:"_oids",type:"mixed"}),d.Builder.cacheColumns(e);var g=e.column(a).data,h=e.column("count").data,i=e.column("_oids").data,j=e.column(e.idAttribute).data;return this.each(function(c){var d=k(g,c[a],f.type);d===-1?(g.push(c[a]),j.push(b.uniqueId()),h.push(1),i.push([c[this.parent.idAttribute]])):(h[d]+=1,i[d].push(c[this.parent.idAttribute]))},e),d.Builder.cacheRows(e),e},groupBy:function(a,c,e){e=e||{};var f=new d.Derived({parent:this,method:e.method||b.sum,args:arguments});e&&e.preprocess&&(f.preprocess=e.preprocess);var g=b.union([a],c);b.each(g,function(a){this.addColumn({name:a,type:this.parent.column(a).type})},f),d.Builder.cacheColumns(f);var h=function(){var e=this;d.Builder.clearRowCache(this);var f={},g=0,h=this.parent.column(a);for(var i=0;i<this.parent.length;i++){var j=null;this.preprocess?j=this.preprocess(h.data[i]):j=h.data[i],b.isUndefined(f[j])&&(f[j]=g,b.each(c,function(a){var c=this.column(a),d=this.column(this.idAttribute);c.data[g]=[],d.data[g]=b.uniqueId()},this),this.column(a).data[g]=j,g++),b.each(c,function(a){var b=this.column(a),c=f[j];b.data[c].push(this.parent.rowByPosition(i))},this)}var k=this._columns[this._columnPositionByName._oids];return k.data=[],b.each(c,function(a){var c=this.column(a);b.each(c.data,function(d,f){b.isArray(d)&&(k.data[f]=k.data[f]||[],k.data[f].push(b.map(d,function(a){return a[e.parent.idAttribute]})),k.data[f]=b.flatten(k.data[f]),c.data[f]=this.method(b.map(d,function(b){return b[a]})),this.length++)},this)},this),d.Builder.cacheRows(this),this};return f.func=b.bind(h,f),f.func.call(f.args)}})}(this,_);