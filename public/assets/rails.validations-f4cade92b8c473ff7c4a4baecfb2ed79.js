((function(){var a,b,c,d,e=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=jQuery,a.fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},a.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},a.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},a.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return a(this).enableClientSideValidations()}),this},a.fn.isValid=function(e){var f;return f=a(this[0]),f.is("form")?c(f,e):b(f,d(this[0].name,e))},d=function(a,b){return a=a.replace(/_attributes\]\[\w+\]\[(\w+)\]/g,"_attributes][][$1]"),b[a]||{}},c=function(b,c){var d;return b.trigger("form:validate:before.ClientSideValidations"),d=!0,b.find(ClientSideValidations.selectors.validate_inputs).each(function(){return a(this).isValid(c)||(d=!1),!0}),d?b.trigger("form:validate:pass.ClientSideValidations"):b.trigger("form:validate:fail.ClientSideValidations"),b.trigger("form:validate:after.ClientSideValidations"),d},b=function(b,c){var d,e,f,g,h,i,j;return b.trigger("element:validate:before.ClientSideValidations"),i=function(){return b.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},g=function(a){return b.trigger("element:validate:fail.ClientSideValidations",a).data("valid",!1),!1},d=function(){return b.trigger("element:validate:after.ClientSideValidations").data("valid")!==!1},f=function(a){var d,e,f,h,i,j,k,l;h=!0;for(e in a){d=a[e];if(c[e]){l=c[e];for(j=0,k=l.length;j<k;j++){i=l[j];if(f=d.call(a,b,i)){h=g(f);break}}if(!h)break}}return h},e=b.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),a("input[name='"+e+"']").val()==="1"?(i(),d()):b.data("changed")===!1?d():(b.data("changed",!1),h=ClientSideValidations.validators.local,j=ClientSideValidations.validators.remote,f(h)&&f(j)&&i(),d())},window.ClientSideValidations===void 0&&(window.ClientSideValidations={}),window.ClientSideValidations.forms===void 0&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(b){var c,d;c=a(b),ClientSideValidations.disable(b);for(d in b.ClientSideValidations.settings.validators)b.ClientSideValidations.removeError(c.find("[name='"+d+"']"));return ClientSideValidations.enablers.form(b)},window.ClientSideValidations.disable=function(b){var c;return c=a(b),c.off(".ClientSideValidations"),c.is("form")?ClientSideValidations.disable(c.find(":input")):(c.removeData("valid"),c.removeData("changed"),c.filter(":input").each(function(){return a(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(b){var c,d,e,f;c=a(b),b.ClientSideValidations={settings:window.ClientSideValidations.forms[c.attr("id")],addError:function(a,c){return ClientSideValidations.formBuilders[b.ClientSideValidations.settings.type].add(a,b.ClientSideValidations.settings,c)},removeError:function(a){return ClientSideValidations.formBuilders[b.ClientSideValidations.settings.type].remove(a,b.ClientSideValidations.settings)}},f={"submit.ClientSideValidations":function(a){if(!c.isValid(b.ClientSideValidations.settings.validators))return a.preventDefault(),a.stopImmediatePropagation()},"ajax:beforeSend.ClientSideValidations":function(a){if(a.target===this)return c.isValid(b.ClientSideValidations.settings.validators)},"form:validate:after.ClientSideValidations":function(a){return ClientSideValidations.callbacks.form.after(c,a)},"form:validate:before.ClientSideValidations":function(a){return ClientSideValidations.callbacks.form.before(c,a)},"form:validate:fail.ClientSideValidations":function(a){return ClientSideValidations.callbacks.form.fail(c,a)},"form:validate:pass.ClientSideValidations":function(a){return ClientSideValidations.callbacks.form.pass(c,a)}};for(e in f)d=f[e],c.on(e,d);return c.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(b){var c,d,e,f,g,h;d=a(b),g=b.form,c=a(g),h={"focusout.ClientSideValidations":function(){return a(this).isValid(g.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){return a(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(b){return ClientSideValidations.callbacks.element.after(a(this),b)},"element:validate:before.ClientSideValidations":function(b){return ClientSideValidations.callbacks.element.before(a(this),b)},"element:validate:fail.ClientSideValidations":function(b,c){var d;return d=a(this),ClientSideValidations.callbacks.element.fail(d,c,function(){return g.ClientSideValidations.addError(d,c)},b)},"element:validate:pass.ClientSideValidations":function(b){var c;return c=a(this),ClientSideValidations.callbacks.element.pass(c,function(){return g.ClientSideValidations.removeError(c)},b)}};for(f in h)e=h[f],d.filter(":not(:radio):not([id$=_confirmation])").each(function(){return a(this).attr("data-validate",!0)}).on(f,e);return d.filter(":checkbox").on("click.ClientSideValidations",function(){return a(this).isValid(g.ClientSideValidations.settings.validators),!0}),d.filter("[id$=_confirmation]").each(function(){var b,d,h,i;b=a(this),d=c.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input");if(d[0]){h={"focusout.ClientSideValidations":function(){return d.data("changed",!0).isValid(g.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){return d.data("changed",!0).isValid(g.ClientSideValidations.settings.validators)}},i=[];for(f in h)e=h[f],i.push(a("#"+b.attr("id")).on(f,e));return i}})}},window.ClientSideValidations.validators={all:function(){return jQuery.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{presence:function(a,b){if(/^\s*$/.test(a.val()||""))return b.message},acceptance:function(a,b){var c;switch(a.attr("type")){case"checkbox":if(!a.prop("checked"))return b.message;break;case"text":if(a.val()!==(((c=b.accept)!=null?c.toString():void 0)||"1"))return b.message}},format:function(a,b){var c;c=this.presence(a,b);if(c){if(b.allow_blank===!0)return;return c}if(b["with"]&&!b["with"].test(a.val()))return b.message;if(b.without&&b.without.test(a.val()))return b.message},numericality:function(b,c){var d,e,f,g,h,i,j;j=jQuery.trim(b.val());if(!ClientSideValidations.patterns.numericality.test(j)){if(c.allow_blank===!0&&this.presence(b,{message:c.messages.numericality}))return;return c.messages.numericality}if(c.only_integer&&!/^[+-]?\d+$/.test(j))return c.messages.only_integer;d={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},h=a(b[0].form);for(e in d){i=d[e];if(c[e]==null)continue;if(!isNaN(parseFloat(c[e]))&&isFinite(c[e]))f=c[e];else{if(h.find("[name*="+c[e]+"]").size()!==1)return;f=h.find("[name*="+c[e]+"]").val()}j=j.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),g=new Function("return "+j+" "+i+" "+f);if(!g())return c.messages[e]}if(c.odd&&!(parseInt(j,10)%2))return c.messages.odd;if(c.even&&parseInt(j,10)%2)return c.messages.even},length:function(a,b){var c,d,e,f,g,h,i,j;j=b.js_tokenizer||"split('')",i=(new Function("element","return (element.val()."+j+" || '').length"))(a),c={is:"==",minimum:">=",maximum:"<="},d={},d.message=b.is?b.messages.is:b.minimum?b.messages.minimum:void 0,g=this.presence(a,d);if(g){if(b.allow_blank===!0)return;return g}for(e in c){h=c[e];if(!b[e])continue;f=new Function("return "+i+" "+h+" "+b[e]);if(!f())return b.messages[e]}},exclusion:function(a,b){var c,d,f,g,h;d=this.presence(a,b);if(d){if(b.allow_blank===!0)return;return d}if(b["in"])if(h=a.val(),e.call(function(){var a,c,d,e;d=b["in"],e=[];for(a=0,c=d.length;a<c;a++)f=d[a],e.push(f.toString());return e}(),h)>=0)return b.message;if(b.range){c=b.range[0],g=b.range[1];if(a.val()>=c&&a.val()<=g)return b.message}},inclusion:function(a,b){var c,d,f,g,h;d=this.presence(a,b);if(d){if(b.allow_blank===!0)return;return d}if(b["in"]){if(h=a.val(),e.call(function(){var a,c,d,e;d=b["in"],e=[];for(a=0,c=d.length;a<c;a++)f=d[a],e.push(f.toString());return e}(),h)>=0)return;return b.message}if(b.range){c=b.range[0],g=b.range[1];if(a.val()>=c&&a.val()<=g)return;return b.message}},confirmation:function(a,b){if(a.val()!==jQuery("#"+a.attr("id")+"_confirmation").val())return b.message},uniqueness:function(b,c){var d,e,f,g,h,i,j;f=b.attr("name");if(/_attributes\]\[\d/.test(f)){e=f.match(/^(.+_attributes\])\[\d+\](.+)$/),g=e[1],h=e[2],j=b.val();if(g&&h){d=b.closest("form"),i=!0,d.find(':input[name^="'+g+'"][name$="'+h+'"]').each(function(){if(a(this).attr("name")!==f){if(a(this).val()===j)return i=!1,a(this).data("notLocallyUnique",!0);if(a(this).data("notLocallyUnique"))return a(this).removeData("notLocallyUnique").data("changed",!0)}});if(!i)return c.message}}}},remote:{uniqueness:function(a,b){var c,d,e,f,g,h,i,j;e=ClientSideValidations.validators.local.presence(a,b);if(e){if(b.allow_blank===!0)return;return e}c={},c.case_sensitive=!!b.case_sensitive,b.id&&(c.id=b.id);if(b.scope){c.scope={},j=b.scope;for(d in j)g=j[d],i=a.attr("name").replace(/\[\w+\]$/,"["+d+"]"),h=jQuery("[name='"+i+"']"),jQuery("[name='"+i+"']:checkbox").each(function(){if(this.checked)return h=this}),h[0]&&h.val()!==g?(c.scope[d]=h.val(),h.unbind("change."+a.id).bind("change."+a.id,function(){return a.trigger("change.ClientSideValidations"),a.trigger("focusout.ClientSideValidations")})):c.scope[d]=g}/_attributes\]/.test(a.attr("name"))?(f=a.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),f+=/(\[\w+\])$/.exec(a.attr("name"))[1]):f=a.attr("name"),b["class"]&&(f=b["class"]+"["+f.split("[")[1]),c[f]=a.val(),ClientSideValidations.remote_validators_prefix==null&&(ClientSideValidations.remote_validators_prefix="");if(jQuery.ajax({url:""+ClientSideValidations.remote_validators_prefix+"/validators/uniqueness",data:c,async:!1,cache:!1}).status===200)return b.message}}},window.ClientSideValidations.disableValidators=function(){var a,b,c,d;if(window.ClientSideValidations.disabled_validators===void 0)return;c=window.ClientSideValidations.validators.remote,d=[];for(b in c)a=c[b],window.ClientSideValidations.disabled_validators.indexOf(b)!==-1?d.push(delete window.ClientSideValidations.validators.remote[b]):d.push(void 0);return d},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(b,c,d){var e,f,g,h;return e=a(b[0].form),b.data("valid")!==!1&&e.find("label.message[for='"+b.attr("id")+"']")[0]==null&&(f=jQuery(c.input_tag),h=jQuery(c.label_tag),g=e.find("label[for='"+b.attr("id")+"']:not(.message)"),b.attr("autofocus")&&b.attr("autofocus",!1),b.before(f),f.find("span#input_tag").replaceWith(b),f.find("label.message").attr("for",b.attr("id")),h.find("label.message").attr("for",b.attr("id")),h.insertAfter(g),h.find("label#label_tag").replaceWith(g)),e.find("label.message[for='"+b.attr("id")+"']").text(d)},remove:function(b,c){var d,e,f,g,h;e=a(b[0].form),d=jQuery(c.input_tag).attr("class"),f=b.closest("."+d.replace(" ",".")),g=e.find("label[for='"+b.attr("id")+"']:not(.message)"),h=g.closest("."+d);if(f[0])return f.find("#"+b.attr("id")).detach(),f.replaceWith(b),g.detach(),h.replaceWith(g)}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(a,b){},before:function(a,b){},fail:function(a,b,c,d){return c()},pass:function(a,b,c){return b()}},form:{after:function(a,b){},before:function(a,b){},fail:function(a,b){},pass:function(a,b){}}},a(function(){return ClientSideValidations.disableValidators(),a(ClientSideValidations.selectors.forms).validate()})})).call(this);